version: 2

project_name: pgedge-loadgen

before:
    hooks:
        - go mod tidy

builds:
    - id: pgedge-loadgen
      main: ./cmd/pgedge-loadgen
      binary: pgedge-loadgen
      env:
          - CGO_ENABLED=0
      goos:
          - linux
          - darwin
          - windows
      goarch:
          - amd64
          - arm64
      ignore:
          - goos: windows
            goarch: arm64
      ldflags:
          - -s -w
          - -X github.com/pgEdge/pgedge-loadgen/pkg/version.Version={{.Version}}
          - -X github.com/pgEdge/pgedge-loadgen/pkg/version.Commit={{.Commit}}
          - -X github.com/pgEdge/pgedge-loadgen/pkg/version.BuildDate={{.Date}}

archives:
    - id: default
      format: tar.gz
      name_template: >-
          {{ .ProjectName }}_{{ .Version }}_{{ .Os }}_{{ .Arch }}
      format_overrides:
          - goos: windows
            format: zip
      files:
          - README.md
          - LICENSE
          - docs/changelog.md

checksum:
    name_template: "checksums.txt"

snapshot:
    version_template: "{{ incpatch .Version }}-next"

changelog:
    sort: asc
    filters:
        exclude:
            - "^docs:"
            - "^test:"
            - "^chore:"
            - Merge pull request
            - Merge branch

release:
    github:
        owner: pgEdge
        name: pgedge-loadgen
    draft: false
    prerelease: auto
    name_template: "{{.ProjectName}} v{{.Version}}"
